---
 - name: Create a login user
   hosts: web
   become: yes
  
   tasks:
    - name: Ensure groups exists
      group:
       name: "{{ item.group1 }}"
       state: present
      loop:
       - { group1: 'dbadmin' }
       - { group1: 'webadmin' }
      
    - name: Crea usuario
      user:
       name: "{{ item.username }}"
       state: present
       groups: "{{ item.groups }}"
       createhome: yes
       home: "{{ item.home1 }}"
      loop:
       - { username: 'ops1', groups: 'dbadmin', home1: '/home/dbadmin' }
       - { username: 'ops2', groups: 'dbadmin', home1: '/home/dbadmin' }
       - { username: 'ops3', groups: 'webadmin', home1: '/home/webadmin' }
    
